graph TD
    subgraph "Data Sources"
        EXT_API[External APIs<br/>ğŸ’° Financial Data<br/>ğŸ“Š Macro Data]
        UPLOAD[File Uploads<br/>ğŸ“„ CSV/Excel<br/>ğŸ¢ Company Data]
        MANUAL[Manual Input<br/>âœï¸ Streamlit UI<br/>ğŸ¯ Individual Scoring]
    end
    
    subgraph "Data Ingestion Layer"
        INGEST[Data Ingestion Service<br/>ğŸ“¥ Collection & Validation]
        VALIDATE[Data Validation<br/>âœ… Quality Checks<br/>ğŸ” Schema Validation<br/>ğŸ“Š Statistical Tests]
    end
    
    subgraph "Data Processing Layer"
        CLEAN[Data Cleaning<br/>ğŸ§¹ Missing Values<br/>ğŸ”§ Outlier Detection<br/>ğŸ“ Normalization]
        FEATURE[Feature Engineering<br/>âš™ï¸ Ratio Calculation<br/>ğŸ“ˆ Trend Analysis<br/>ğŸ”„ Transformations]
        ENRICH[Data Enrichment<br/>ğŸŒŸ Sector Benchmarks<br/>ğŸ“Š Macro Integration<br/>ğŸ“… Time Features]
    end
    
    subgraph "Storage Layer"
        RAW_DB[(Raw Data Store<br/>ğŸ—„ï¸ PostgreSQL<br/>ğŸ“Š Staging Tables)]
        PROC_DB[(Processed Data<br/>ğŸ—„ï¸ PostgreSQL<br/>âœ¨ Clean Features)]
        CACHE[(Cache Layer<br/>âš¡ Redis<br/>ğŸš€ Fast Access)]
    end
    
    subgraph "ML Pipeline"
        TRAIN[Model Training<br/>ğŸ§  XGBoost<br/>ğŸ¯ Hyperparameter Tuning<br/>ğŸ“Š Cross Validation]
        VALIDATE_ML[Model Validation<br/>ğŸ“ˆ Performance Metrics<br/>ğŸ¯ ROC-AUC, Brier<br/>ğŸ“Š Backtesting]
        DEPLOY[Model Deployment<br/>ğŸš€ Production Ready<br/>ğŸ“¦ Serialization<br/>ğŸ”„ Versioning]
    end
    
    subgraph "Prediction Pipeline"
        PREDICT[Prediction Engine<br/>ğŸ¯ ML Inference<br/>ğŸ“Š Altman Z-Score<br/>ğŸ”„ Blended Score]
        EXPLAIN[Explainability<br/>ğŸ” Feature Importance<br/>ğŸ“Š SHAP Values<br/>ğŸ’¡ Insights]
        STORE_PRED[Store Predictions<br/>ğŸ’¾ Database<br/>ğŸ“… Timestamped<br/>ğŸ”„ Versioned]
    end
    
    subgraph "Alert Pipeline"
        MONITOR[Risk Monitoring<br/>ğŸ‘ï¸ Threshold Checks<br/>ğŸ“ˆ Trend Analysis<br/>ğŸš¨ Rule Engine]
        ALERT[Alert Generation<br/>ğŸš¨ Smart Alerts<br/>ğŸ“§ Multi-channel<br/>âš¡ Real-time]
        NOTIFY[Notification Delivery<br/>ğŸ“§ Email<br/>ğŸ’¬ Slack<br/>ğŸ‘¥ Teams]
    end
    
    subgraph "Analytics & Reporting"
        ANALYTICS[Analytics Engine<br/>ğŸ“Š Aggregations<br/>ğŸ“ˆ Trends<br/>ğŸ¯ KPIs]
        POWERBI[Power BI<br/>ğŸ“Š Dashboards<br/>ğŸ“ˆ Executive Reports<br/>ğŸ¯ Drill-down]
        STREAMLIT[Streamlit UI<br/>ğŸ–¥ï¸ Interactive<br/>ğŸ¯ Self-service<br/>ğŸ“Š Visualizations]
    end
    
    %% Data Flow Connections
    EXT_API --> INGEST
    UPLOAD --> INGEST
    MANUAL --> PREDICT
    
    INGEST --> VALIDATE
    VALIDATE --> RAW_DB
    
    RAW_DB --> CLEAN
    CLEAN --> FEATURE
    FEATURE --> ENRICH
    ENRICH --> PROC_DB
    
    PROC_DB --> CACHE
    PROC_DB --> TRAIN
    
    TRAIN --> VALIDATE_ML
    VALIDATE_ML --> DEPLOY
    DEPLOY --> PREDICT
    
    CACHE --> PREDICT
    PREDICT --> EXPLAIN
    PREDICT --> STORE_PRED
    EXPLAIN --> STORE_PRED
    
    STORE_PRED --> MONITOR
    MONITOR --> ALERT
    ALERT --> NOTIFY
    
    STORE_PRED --> ANALYTICS
    ANALYTICS --> POWERBI
    ANALYTICS --> STREAMLIT
    
    PROC_DB --> ANALYTICS
    
    %% Feedback Loops
    VALIDATE_ML -.-> FEATURE
    MONITOR -.-> TRAIN
    ANALYTICS -.-> VALIDATE
    
    %% Styling
    classDef source fill:#e3f2fd,stroke:#0277bd,stroke-width:2px
    classDef ingestion fill:#e8f5e8,stroke:#2e7d32,stroke-width:2px
    classDef processing fill:#fff3e0,stroke:#f57c00,stroke-width:2px
    classDef storage fill:#fce4ec,stroke:#c2185b,stroke-width:2px
    classDef ml fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px
    classDef prediction fill:#e0f2f1,stroke:#00695c,stroke-width:2px
    classDef alert fill:#ffebee,stroke:#d32f2f,stroke-width:2px
    classDef analytics fill:#f1f8e9,stroke:#558b2f,stroke-width:2px
    
    class EXT_API,UPLOAD,MANUAL source
    class INGEST,VALIDATE ingestion
    class CLEAN,FEATURE,ENRICH processing
    class RAW_DB,PROC_DB,CACHE storage
    class TRAIN,VALIDATE_ML,DEPLOY ml
    class PREDICT,EXPLAIN,STORE_PRED prediction
    class MONITOR,ALERT,NOTIFY alert
    class ANALYTICS,POWERBI,STREAMLIT analytics

